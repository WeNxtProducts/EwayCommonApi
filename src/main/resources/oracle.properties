#INS_PMT_CLAIM_UG=SELECT pp.POLH_SYS_ID POLH_SYS_ID, pp.POLH_NO POLH_NO, pp.POLH_PROD_CODE POLH_PROD_CODE, pp.POLH_DIVN_CODE POLH_DIVN_CODE, pp.POLH_END_NO_IDX POLH_END_NO_IDX, pp.POLH_END_SR_NO POLH_END_SR_NO, pp.POLH_COMP_CODE POLH_COMP_CODE, pp.POLH_DEPT_CODE POLH_DEPT_CODE, pp.POLH_CLASS_CODE POLH_CLASS_CODE, pp.POLH_CUST_CODE POLH_CUST_CODE, pp.POLH_ASSR_CODE POLH_ASSR_CODE, pp.POLH_ASSR_NAME POLH_ASSR_NAME, pp.POLH_FAC_YN POLH_FAC_YN, cid.ACCIDENT_DATE ACCIDENT_DATE, cid.ENTRY_DATE ENTRY_DATE, sysdate CURRENT_DATE, cid.CREATED_BY CREATED_BY, cid.REMARKS REMARKS, cid.ASSIGNED_DATE APPROVED_DATE, cid.CLAIM_OFFICER_ID CLAIM_OFFICER_ID, cid.LATTITUDE LATTITUDE, cid.LONGTITUDE LONGTITUDE, cid.ASSURED_NAME ASSURED_NAME, cid.ASSURED_ADDRESS ASSURED_ADDRESS, cid.CONTACT_NO CONTACT_NO, cid.FAX_NO FAX_NO, cid.EMAIL EMAIL, cid.INSIDEAFRICA_YN INSIDEAFRICA_YN, sysdate CLM_YEAR FROM pgith_pol_risk_addl_info ppr, pgith_policy pp,claim_intimation_detail cid WHERE pp.polh_no =cid.policy_no AND nvl(ppr.praih_data_03,ppr.praih_data_01) =cid.chassissno AND cid.claim_ref_no=? and pp.polh_end_no_idx =( SELECT MAX(polh_end_no_idx) FROM pgith_policy pp1 WHERE pp1.polh_no = pp.polh_no) AND ppr.praih_pol_sys_id = pp.polh_sys_id AND ppr.praih_end_no_idx = pp.polh_end_no_idx
INS_MOTOR_DATA=SELECT em.COMPANY_ID COMPANY_ID, em.BRANCH_CODE BRANCH_CODE, em.PRODUCT_ID PRODUCT_ID, em.SECTION_ID SECTION_ID,em.QUOTE_NO QUOTE_NO FROM home_position_master em WHERE em.QUOTE_NO=?1

#YI_POLICY_DETAIL =SELECT  em.CUSTOMER_CODE CUSTOMER_CODE,  em.QUOTE_CREATED_DATE POLICY_ISSUE_DT, em.EXPIRY_DATE PERIOD_TO, em.INCEPTION_DATE PERIOD_FROM, pi.ID_NUMBER CIVIL_ID, pi.EMAIL_1 CONTACT_EMAIL_ID, pi.CLIENT_NAME CONTACT_PER_NAME,  em.CURRENCY PREM_CURR, em.ENTRY_DATE QUOTE_RECEIVED_DT, em.CURRENCY SI_CURR, pi.ADDRESS_1 ADDRESS_LINE1, pi.ADDRESS_2 ADDRESS_LINE2, pi.STATE_NAME STATE, pi.CITY_NAME CITY, pi.CUSTOMER_REFERENCE_NO CUST_REF, em.QUOTE_CREATED_DATE ISSUED_AT,  pi.CLIENT_NAME INSURED_FIRSTNAME, PI.MOBILE_NO_1 INSURED_PHONE_NUMBER, pi.EMAIL_1 INSURED_EMAILID, em.REQUEST_REFERENCE_NO REQUESTREFERENCENO, pi.CLIENT_NAME INSURED, em.INTEGRATION_STATUS INTEGRATION_STATUS , em.QUOTE_CREATED_DATE QUOTATION_ISSUE_DT, em.APPLICATION_ID UW_ID , em.BRANCH_NAME BRANCH_NAME, em.ENTRY_DATE DATE_OF_COLLECTION,  pd.ACCOUNT_NUMBER CREDIT_CARD_NO , pd.PAYMENT_ID TRANSACTION_ID, pd.ENTRY_DATE TRANSACTION_DATE, em.OVERALL_PREMIUM_LC NET_PREMIUM, em.PROMOCODE PROMOCODE, pi.CLIENT_NAME CUSTOMER, PI.MOBILE_NO_1 INSURED_PHONE_NUMBER, em.QUOTE_CREATED_DATE POLICY_ISSUE_DT FROM home_position_master em, personal_info PI, payment_detail pd, motor_data_details mdd, policy_cover_data pcd WHERE em.CUSTOMER_ID = pi.CUSTOMER_ID AND em.QUOTE_NO = pd.QUOTE_NO AND pd.PAYMENT_STATUS = 'ACCEPTED' AND pcd.QUOTE_NO = em.QUOTE_NO AND PCD.PRODUCT_ID = em.PRODUCT_ID AND mdd.QUOTE_NO = em.QUOTE_NO AND em.QUOTE_NO =?1 LIMIT 1
YI_POLICY_DETAIL =SELECT em.CUSTOMER_CODE CUSTOMER_CODE, em.QUOTE_CREATED_DATE POLICY_ISSUE_DT, em.EXPIRY_DATE PERIOD_TO, em.INCEPTION_DATE PERIOD_FROM, pi.ID_NUMBER CIVIL_ID, pi.EMAIL_1 CONTACT_EMAIL_ID, pi.CLIENT_NAME CONTACT_PER_NAME, em.CURRENCY PREM_CURR, em.ENTRY_DATE QUOTE_RECEIVED_DT, em.CURRENCY SI_CURR, pi.ADDRESS_1 ADDRESS_LINE1, pi.ADDRESS_2 ADDRESS_LINE2, pi.STATE_NAME STATE, pi.CITY_NAME CITY, pi.CUSTOMER_REFERENCE_NO CUST_REF, em.QUOTE_CREATED_DATE ISSUED_AT, pi.CLIENT_NAME INSURED_FIRSTNAME, PI.MOBILE_NO_1 INSURED_PHONE_NUMBER, pi.EMAIL_1 INSURED_EMAILID, em.REQUEST_REFERENCE_NO REQUESTREFERENCENO, pi.CLIENT_NAME INSURED, em.INTEGRATION_STATUS INTEGRATION_STATUS, em.QUOTE_CREATED_DATE QUOTATION_ISSUE_DT, em.APPLICATION_ID UW_ID, em.BRANCH_NAME BRANCH_NAME, em.ENTRY_DATE DATE_OF_COLLECTION, pd.ACCOUNT_NUMBER CREDIT_CARD_NO, pd.PAYMENT_ID TRANSACTION_ID, pd.ENTRY_DATE TRANSACTION_DATE, em.OVERALL_PREMIUM_LC NET_PREMIUM, em.PROMOCODE PROMOCODE, pi.CLIENT_NAME CUSTOMER, PI.MOBILE_NO_1 INSURED_PHONE_NUMBER, em.QUOTE_CREATED_DATE POLICY_ISSUE_DT, pcd.PREMIUM_INCLUDED_TAX_LC PREMIUM, em.EXCHANGE_RATE EXCHANGE_RATE, PI.ID_NUMBER ID_NUMBER , PI.ID_TYPE_DESC ID_TYPE_DESC, em.ADMIN_LOGIN_ID APPR_UID, em.APPR_CAN_DT APPR_CAN_DT,em.ENDT_COUNT ENDT_COUNT,em.COMMISSION_PERCENTAGE COMMISSION_PERCENTAGE  FROM home_position_master em, personal_info PI, payment_detail pd, policy_cover_data pcd WHERE em.CUSTOMER_ID = pi.CUSTOMER_ID AND em.QUOTE_NO = pd.QUOTE_NO AND pd.PAYMENT_STATUS = 'ACCEPTED' AND pcd.QUOTE_NO = em.QUOTE_NO AND PCD.PRODUCT_ID = em.PRODUCT_ID AND em.QUOTE_NO = ?1 LIMIT 1

YI_SECTION_DETAIL =SELECT em.REQUEST_REFERENCE_NO REQUESTREFERENCENO, em.POLICY_NO QUOTATION_POLICY_NO, sdd.risk_id RISK_ID,em.ENDT_COUNT ENDT_COUNT  FROM home_position_master em, section_data_details sdd WHERE sdd.quote_no=em.QUOTE_No and em.QUOTE_NO = ? 

#For Tanzania Risk--------
#MOTOR_RISK_DETAIL =SELECT MDD.VEHICLE_ID AS RISK_ID, MDD.STATUS AS STATUS, MDD.CHASSIS_NUMBER AS CHASSIS_NUMBER, MDD.REGISTRATION_NUMBER AS REGISTRATION_NUMBER, MDD.ENGINE_NUMBER AS ENGINE_NUMBER, MDD.FUEL_TYPE AS FUEL_TYPE, MDD.MANUFACTURE_YEAR AS MANUFACTURE_YEAR, HPM.NO_OF_VEHICLES AS NO_OF_VEHICLES, MDD.GROSS_WEIGHT AS GROSS_WEIGHT, MDD.CUBIC_CAPACITY AS CUBIC_CAPACITY, MDD.SEATING_CAPACITY AS SEATING_CAPACITY, MDD.TARE_WEIGHT AS TARE_WEIGHT, HPM.POLICY_NO AS POLICY_NO, MDD.SEATING_CAPACITY AS PRAI_NUM_03, MDD.NCD_YN AS NCD_YN,HPM.ENDT_COUNT ENDT_COUNT FROM HOME_POSITION_MASTER HPM, MOTOR_DATA_DETAILS MDD, PERSONAL_INFO PIF WHERE HPM.QUOTE_NO = MDD.QUOTE_NO AND PIF.CUSTOMER_ID = HPM.CUSTOMER_ID  AND HPM.QUOTE_NO =?1
MOTOR_RISK_DETAIL =SELECT MDD.VEHICLE_ID AS RISK_ID, MDD.STATUS AS STATUS, MDD.CHASSIS_NUMBER AS CHASSIS_NUMBER, MDD.REGISTRATION_NUMBER AS REGISTRATION_NUMBER, MDD.ENGINE_NUMBER AS ENGINE_NUMBER, MDD.FUEL_TYPE AS FUEL_TYPE, MDD.MANUFACTURE_YEAR AS MANUFACTURE_YEAR, HPM.NO_OF_VEHICLES AS NO_OF_VEHICLES, MDD.GROSS_WEIGHT AS GROSS_WEIGHT, MDD.CUBIC_CAPACITY AS CUBIC_CAPACITY, MDD.SEATING_CAPACITY AS SEATING_CAPACITY, MDD.TARE_WEIGHT AS TARE_WEIGHT, HPM.POLICY_NO AS POLICY_NO, MDD.SEATING_CAPACITY AS PRAI_NUM_03, MDD.NCD_YN AS NCD_YN, HPM.ENDT_COUNT ENDT_COUNT, SDD.STICKER_NUMBER STICKER_NUMBER FROM HOME_POSITION_MASTER HPM, MOTOR_DATA_DETAILS MDD, PERSONAL_INFO PIF, SECTION_DATA_DETAILS SDD WHERE HPM.QUOTE_NO = MDD.QUOTE_NO AND PIF.CUSTOMER_ID = HPM.CUSTOMER_ID AND SDD.QUOTE_NO = HPM.QUOTE_NO  AND SDD.RISK_ID=MDD.VEHICLE_ID AND HPM.QUOTE_NO = ?1
#-----------
#YI_RISK_DETAIL =SELECT pi.ADDRESS1 ADDRESS, em.CUSTOMER_NAME INSURED_NAME, em.INCEPTION_DATE POLICY_PERIOD_FROM, em.POLICY_NO QUOTATION_POLICY_NO, mdd.REGISTRATION_NUMBER REGISTRATION_NUMBER, em.REQUEST_REFERENCE_NO REQUESTREFERENCENO, em.SECTION_ID SEC_CODE, mdd.REGISTRATION_YEAR YEAR_OF_BUILD, mdd.MANUFACTURE_YEAR YEAR_OF_MAKE FROM FROM home_position_master em, personal_info pi, motor_data_details mdd WHERE em.QUOTE_NO = pi.QUOTE_NO AND em.QUOTE_NO = mdd.QUOTE_NO AND em.QUOTE_NO=?1  
YI_RISK_DETAIL = SELECT PI.ADDRESS_1 ADDRESS, em.CUSTOMER_NAME INSURED_NAME, em.INCEPTION_DATE POLICY_PERIOD_FROM, em.POLICY_NO QUOTATION_POLICY_NO, mdd.REGISTRATION_NUMBER REGISTRATION_NUMBER, em.REQUEST_REFERENCE_NO REQUESTREFERENCENO, em.SECTION_ID SEC_CODE, mdd.REGISTRATION_YEAR YEAR_OF_BUILD, mdd.MANUFACTURE_YEAR YEAR_OF_MAKE,em.ENDT_COUNT ENDT_COUNT FROM home_position_master em, personal_info pi, motor_data_details mdd WHERE em.CUSTOMER_ID =PI.CUSTOMER_ID AND em.QUOTE_NO = mdd.QUOTE_NO AND em.QUOTE_NO=?1

MOT_DRIVER_DETAIL=SELECT em.REQUEST_REFERENCE_NO REQUESTREFERENCENO,em.QUOTE_NO QUOTE_NO, mdd.ID_NUMBER ID_RESIDENT_NO, em.POLICY_NO QUOTATION_POLICY_NO, mdd.DRIVER_DOB DATE_OF_BIRTH, mdd.DRIVER_NAME NAME, mdd.RISK_ID RISK_ID , em.RENEWAL_OLD_POLICY RENEWAL_POLICY_NO,em.ENDT_COUNT ENDT_COUNT  FROM home_position_master em, motor_driver_details mdd WHERE em.QUOTE_NO=mdd.QUOTE_NO AND em.QUOTE_NO=?1 

#YI_COVER_DETAIL =SELECT em.REQUEST_REFERENCE_NO REQUESTREFERENCENO,mdd.SUM_INSURED SUM_INSURED, pcd.COVER_ID COVER_CODE,pcd.RATE RATE, em.RENEWAL_STATUS RENEWAL_CURRENT_STATUS,pcd.PREMIUM_INCLUDED_TAX_LC PREMIUM, pcd.COVER_NAME COVER_DESC,em.POLICY_NO QUOTATION_POLICY_NO,pcd.COVER_ID CVR_ID, em.RENEWAL_OLD_POLICY RENEWAL_POLICY_NO ,pcd.VEHICLE_ID RISK_ID FROM home_position_master em, policy_cover_data pcd, motor_data_details mdd WHERE em.Quote_No=mdd.Quote_NO and pcd.QUOTE_NO = mdd.QUOTE_NO AND pcd.TAX_ID = '0' AND pcd.Disc_load_Id = '0' AND em.QUOTE_NO = mdd.QUOTE_NO AND PCD.vehicle_ID = mdd.VEHICLE_ID AND em.QUOTE_NO =?1     
#YI_COVER_DETAIL = SELECT em.REQUEST_REFERENCE_NO REQUESTREFERENCENO, mdd.SUM_INSURED SUM_INSURED, pcd.RATE RATE, em.RENEWAL_STATUS RENEWAL_CURRENT_STATUS, pcd.PREMIUM_INCLUDED_TAX_LC PREMIUM, pcd.COVER_NAME COVER_DESC, em.POLICY_NO QUOTATION_POLICY_NO, pcd.COVER_ID CVR_ID, em.RENEWAL_OLD_POLICY RENEWAL_POLICY_NO, pcd.VEHICLE_ID RISK_ID FROM home_position_master em, policy_cover_data pcd, motor_data_details mdd WHERE em.Quote_No = mdd.Quote_NO AND pcd.QUOTE_NO = mdd.QUOTE_NO AND pcd.TAX_ID = '0' AND pcd.Disc_load_Id = '0' AND em.QUOTE_NO = mdd.QUOTE_NO AND PCD.vehicle_ID = mdd.VEHICLE_ID AND em.QUOTE_NO = ?1
YI_COVER_DETAIL = SELECT em.REQUEST_REFERENCE_NO REQUESTREFERENCENO, pcd.SUM_INSURED SUM_INSURED , pcd.RATE RATE, em.RENEWAL_STATUS RENEWAL_CURRENT_STATUS, pcd.PREMIUM_INCLUDED_TAX_LC PREMIUM, pcd.COVER_NAME COVER_DESC, em.POLICY_NO QUOTATION_POLICY_NO, pcd.COVER_ID CVR_ID, em.RENEWAL_OLD_POLICY RENEWAL_POLICY_NO, pcd.VEHICLE_ID RISK_ID,pcd.PREMIUM_INCLUDED_TAX_FC PREMIUM_FC,em.ENDT_COUNT ENDT_COUNT   FROM home_position_master em, policy_cover_data pcd WHERE pcd.QUOTE_NO = em.QUOTE_NO AND pcd.TAX_ID = '0' AND pcd.Disc_load_Id = '0' AND em.QUOTE_NO = ?1
 
#MOT_COMM_DISCOUNT=SELECT em.REQUEST_REFERENCE_NO REQUESTREFERENCENO, pcd.VEHICLE_ID RISK_ID, em.POLICY_NO QUOTATION_POLICY_NO  FROM home_position_master em , policy_cover_data pcd WHERE em.quote_no =pcd.quote_no AND pcd.TAX_ID='0' And Disc_load_Id<>'0' AND COVERAGE_TYPE ='D'  AND em.QUOTE_NO=?1
MOT_COMM_DISCOUNT = SELECT em.REQUEST_REFERENCE_NO REQUESTREFERENCENO, pcd.VEHICLE_ID RISK_ID, em.POLICY_NO QUOTATION_POLICY_NO,em.ENDT_COUNT ENDT_COUNT  FROM home_position_master em, policy_cover_data pcd , motor_data_details mdd WHERE em.quote_no = pcd.quote_no AND em.Quote_No = mdd.Quote_NO AND pcd.TAX_ID = '0' AND Disc_load_Id <> '0' AND COVERAGE_TYPE = 'D' AND pcd.vehicle_id=mdd.vehicle_id AND em.QUOTE_NO = ?1

#YI_CHARGE_DETAIL =SELECT em.REQUEST_REFERENCE_NO REQUESTREFERENCENO,em.PRODUCT_ID PROD_CODE,em.POLICY_NO QUOTATION_POLICY_NO  FROM home_position_master em WHERE em.QUOTE_NO=?1
YI_CHARGE_DETAIL =SELECT em.REQUEST_REFERENCE_NO REQUESTREFERENCENO, em.VAT_PREMIUM_LC VAT_AMOUNT, em.POLICY_NO QUOTATION_POLICY_NO, em.VAT_PERCENT VAT_PERC,em.ENDT_COUNT ENDT_COUNT  FROM home_position_master em WHERE em.QUOTE_NO = ?1

YI_VAT_DETAIL = SELECT em.REQUEST_REFERENCE_NO REQUESTREFERENCENO,em.VAT_PREMIUM_LC VAT_AMOUNT, em.POLICY_NO QUOTATION_POLICY_NO,em.VAT_PERCENT VAT_PERC,em.ENDT_COUNT ENDT_COUNT  FROM home_position_master em WHERE em.QUOTE_NO=?1

#YI_PREM_CAL =SELECT em.REQUEST_REFERENCE_NO REQUESTREFERENCENO,pcd.SUM_INSURED SUM_INSURED, pcd.COVER_ID COVER_CODE, em.RENEWAL_STATUS RENEWAL_CURRENT_STATUS, pcd.COVER_NAME COVER_DESCRIPTION,pcd.PREMIUM_INCLUDED_TAX_FC COVER_PREMIUM, em.POLICY_NO QUOTATION_POLICY_NO,em.PRODUCT_ID PRODUCT_CODE, pcd.VEHICLE_ID RISK_ID,em.RENEWAL_OLD_POLICY RENEWAL_POLICY_NO FROM home_position_master em, policy_cover_data pcd WHERE em.QUOTE_NO = pcd.QUOTE_NO AND pcd.TAX_ID='0' AND pcd.DISC_LOAD_ID='0' AND em.QUOTE_NO=?1 
#YI_PREM_CAL = SELECT em.REQUEST_REFERENCE_NO REQUESTREFERENCENO, pcd.SUM_INSURED SUM_INSURED, em.RENEWAL_STATUS RENEWAL_CURRENT_STATUS, pcd.COVER_NAME COVER_DESCRIPTION, pcd.PREMIUM_INCLUDED_TAX_FC COVER_PREMIUM, em.POLICY_NO QUOTATION_POLICY_NO, em.PRODUCT_ID PRODUCT_CODE, pcd.VEHICLE_ID RISK_ID, em.RENEWAL_OLD_POLICY RENEWAL_POLICY_NO FROM home_position_master em, policy_cover_data pcd, motor_data_details mdd WHERE em.QUOTE_NO = pcd.QUOTE_NO AND em.Quote_No = mdd.Quote_NO AND mdd.Quote_NO = pcd.QUOTE_NO AND pcd.vehicle_id=mdd.vehicle_id AND pcd.TAX_ID = '0' AND pcd.DISC_LOAD_ID = '0' AND em.QUOTE_NO = ?1
YI_PREM_CAL = SELECT em.REQUEST_REFERENCE_NO REQUESTREFERENCENO, pcd.SUM_INSURED SUM_INSURED, em.RENEWAL_STATUS RENEWAL_CURRENT_STATUS, pcd.COVER_NAME COVER_DESCRIPTION, pcd.PREMIUM_INCLUDED_TAX_FC COVER_PREMIUM, em.POLICY_NO QUOTATION_POLICY_NO, em.PRODUCT_ID PRODUCT_CODE, pcd.VEHICLE_ID RISK_ID, em.RENEWAL_OLD_POLICY RENEWAL_POLICY_NO,em.ENDT_COUNT ENDT_COUNT  FROM home_position_master em, policy_cover_data pcd WHERE em.QUOTE_NO = pcd.QUOTE_NO AND pcd.TAX_ID = '0' AND pcd.DISC_LOAD_ID = '0' AND em.QUOTE_NO = ?1

YI_POLICY_APPROVAL =SELECT em.POLICY_NO QUOTATION_POLICY_NO, em.RENEWAL_STATUS RENEWAL_CURRENT_STATUS,em.RENEWAL_OLD_POLICY RENEWAL_POLICY_NO,em.REQUEST_REFERENCE_NO REQUESTREFERENCENO,em.ENDT_COUNT ENDT_COUNT  FROM home_position_master em WHERE em.QUOTE_NO=?1
  
CREDIT_LIMIT_DETAIL =SELECT em.REQUEST_REFERENCE_NO REQUESTREFERENCENO, em.CUSTOMER_ID CUSTOMER_CODE,em.ENDT_COUNT ENDT_COUNT  FROM home_position_master em, personal_info PI WHERE  em.CUSTOMER_ID = pi.CUSTOMER_ID  AND em.QUOTE_NO =?1 LIMIT 1  
         
YI_SMI_COVER_DETAIL =SELECT em.POLICY_NO QUOTATION_POLICY_NO, em.REQUEST_REFERENCE_NO REQUESTREFERENCENO,em.SECTION_ID SEC_CODE, pcd.SUM_INSURED SUM_INSURED FROM FROM home_position_master em, POLICY_COVER_DATA pcd WHERE em.QUOTE_NO = pcd.QUOTE_NO AND em.QUOTE_NO=?1
 
YI_ADDITIONAL_DETAILS =SELECT HPM.COMPANY_ID COMPANY_ID , HPM.BROKER_CODE RSA_BROKER_CODE, HPM.POLICY_TERM POLICY_TERM, HPM.LOGIN_ID LOGIN_ID, HPM.QUOTE_NO QUOTE_NO, HPM.ENDT_PREV_POLICY_NO PREV_POLICYNO FROM HOME_POSITION_MASTER HPM WHERE QUOTE_NO=?1 
 
 #Employers liability Risk Details
 EMP_LIABILITY_RISK_DETAIL=SELECT HPM.REMARKS REMARKS, HPM.POLICY_PERIOD POLICY_PERIOD, PED.SALARY SALARY, PED.LOCATION_NAME LOCATION_NAME, PED.SECTION_ID SECTION_ID, PED.EMPLOYEE_ID EMPLOYEE_ID, PED.OCCUPATION_ID OCCUPATION_ID, PED.OCCUPATION_DESC OCCUPATION_DESC, HPM.POLICY_NO POLICY_NO FROM HOME_POSITION_MASTER HPM, PRODUCT_EMPLOYEE_DETAILS PED WHERE PED.QUOTE_NO=?1 AND PED.QUOTE_NO=HPM.QUOTE_NO
 BURGLARY_RISK_DETAIL=SELECT INDUSTRY_ID INDUSTRY_ID, WALL_TYPE WALL_TYPE, ROOF_TYPE ROOF_TYPE, DOORS_MATERIAL_ID DOORS_MATERIAL_ID, BUILDING_ADDRESS BUILDING_ADDRESS, WINDOWS_MATERIAL_ID WINDOWS_MATERIAL_ID, HPM.EFFECTIVE_DATE EFFECTIVE_DATE, HPM.EXPIRY_DATE EXPIRY_DATE, BD.RISK_ID RISK_ID, BD.BURGLARY_SI BURGLARY_SI, BD.WATCHMAN_GUARD_HOURS WATCHMAN_GUARD_HOURS FROM BUILDING_RISK_DETAILS BD, HOME_POSITION_MASTER HPM, BUILDING_DETAILS BA WHERE HPM.QUOTE_NO = ?1 AND HPM.QUOTE_NO = BD.QUOTE_NO AND BD.QUOTE_NO = BA.QUOTE_NO AND BD.SECTION_ID !='0'
 FIRE_RISK_DETAIL=SELECT BD.INDUSTRY_ID INDUSTRY_ID, BD.RISK_ID RISK_ID, BD.SECTION_ID SECTION_ID, HPM.EFFECTIVE_DATE EFFECTIVE_DATE, HPM.EXPIRY_DATE EXPIRY_DATE, BUILDING_ADDRESS BUILDING_ADDRESS, HPM.REMARKS REMARKS, BD.SECTION_DESC SECTION_DESC FROM BUILDING_RISK_DETAILS BD, HOME_POSITION_MASTER HPM, BUILDING_DETAILS BA WHERE HPM.QUOTE_NO = ?1 AND HPM.QUOTE_NO = BD.QUOTE_NO AND BD.SECTION_ID != '0' AND BD.QUOTE_NO = BA.QUOTE_NO
 MONEY_RISK_DETAIL=SELECT BD.INDUSTRY_ID INDUSTRY_ID, BD.SECTION_DESC SECTION_DESC, BD.SECTION_ID SECTION_ID, PIF.CLIENT_NAME CLIENT_NAME, BUILDING_ADDRESS BUILDING_ADDRESS, PIF.OCCUPATION_DESC OCCUPATION_DESC, PIF.OCCUPATION OCCUPATION, BD.MONEY_ANNUAL_ESTIMATE MONEY_ANNUAL_ESTIMATE, BD.MONEY_SAFE_LIMIT MONEY_SAFE_LIMIT, BD.STRONGROOM_SI STRONGROOM_SI, BD.MONEY_DIRECTOR_RESIDENCE MONEY_DIRECTOR_RESIDENCE, BD.MONEY_MAJOR_LOSS MONEY_MAJOR_LOSS, HPM.REMARKS REMARKS, BD.RISK_ID RISK_ID FROM BUILDING_RISK_DETAILS BD, HOME_POSITION_MASTER HPM, BUILDING_DETAILS BA, PERSONAL_INFO PIF WHERE HPM.QUOTE_NO = ?1 AND HPM.QUOTE_NO = BD.QUOTE_NO AND BD.SECTION_ID != '0' AND BD.QUOTE_NO = BA.QUOTE_NO AND HPM.CUSTOMER_ID = PIF.CUSTOMER_ID
 MACHINARYBREAKDONW_RISK_DETAIL=SELECT BA.BUILDING_ADDRESS,CT.TYPE_DESC,HPM.ORIGINAL_POLICY_NO,HPM.POLICY_NO,HPM.POLICY_PERIOD,HPM.REMARKS,BD.SECTION_ID,BD.RISK_ID, HPM.REQUEST_REFERENCE_NO,HPM.EFFECTIVE_DATE,HPM.EXPIRY_DATE FROM BUILDING_RISK_DETAILS BD,HOME_POSITION_MASTER HPM,BUILDING_DETAILS BA,CONTENT_AND_RISK CT WHERE HPM.QUOTE_NO=?1 AND HPM.QUOTE_NO=BD.QUOTE_NO AND BD.SECTION_ID !='0' AND BD.QUOTE_NO=BA.QUOTE_NO AND HPM.QUOTE_NO=CT.QUOTE_NO;
#Madison My Sql
MADISON_PT_MAIN_DETAILS =SELECT HPM.POLICY_NO POLICY_NO, HPM.BRANCH_CODE BRANCH_CODE, CPM.CORE_APP_CODE PRODUCT_CODE, HPM.BROKER_CODE BROKER_CODE, HPM.CUSTOMER_NAME CUSTOMER_NAME, PIN.CUSTOMER_REFERENCE_NO CUSTOMER_CODE, PIN.EMAIL_1 EMAIL, ADDRESS_1  ADDRESS, CITY_NAME  CITY_NAME, PIN_CODE PIN_CODE, PIN.MOBILE_NO_1  MOBILE_NO,  HPM.EFFECTIVE_DATE EFFECTIVE_DATE, HPM.EXPIRY_DATE EXPIRY_DATE, HPM.CURRENCY CURRENCY, ECM.CORE_APP_CODE AS CURRENCY_CODE, HPM.EXCHANGE_RATE EXCHANGE_RATE, HPM.POLICY_TERM POLICY_TERM, HPM.LOGIN_ID LOGIN_ID, HPM.QUOTE_NO QUOTE_NO, PIN.POLICY_HOLDER_TYPE_DESC POLICY_HOLDER_TYPE_DESC, PIN.OCCUPATION_DESC OCCUPATION_DESC, PIN.CLIENT_NAME FIRST_NAME, PD.PAYMENT_ID PAYMENT_ID, PD.UPDATED_DATE  PAYMENT_DATE  FROM HOME_POSITION_MASTER HPM ,COMPANY_PRODUCT_MASTER CPM, PERSONAL_INFO PIN,EWAY_CURRENCY_MASTER ECM, PAYMENT_DETAIL PD WHERE HPM.QUOTE_NO=?1 AND PD.QUOTE_NO=HPM.QUOTE_NO AND PD.PAYMENT_STATUS='ACCEPTED' AND HPM.COMPANY_ID=CPM.COMPANY_ID AND HPM.PRODUCT_ID=CPM.PRODUCT_ID AND CPM.STATUS='Y' AND SYSDATE() BETWEEN CPM.EFFECTIVE_DATE_START AND CPM.EFFECTIVE_DATE_END AND CPM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COMPANY_PRODUCT_MASTER WHERE COMPANY_ID = HPM.COMPANY_ID AND PRODUCT_ID = HPM.PRODUCT_ID AND STATUS = 'Y' AND SYSDATE() BETWEEN EFFECTIVE_DATE_START AND EFFECTIVE_DATE_END) AND PIN.CUSTOMER_ID=HPM.CUSTOMER_ID AND ECM.STATUS='Y' AND ECM.CURRENCY_ID=HPM.CURRENCY AND SYSDATE() BETWEEN ECM.EFFECTIVE_DATE_START AND ECM.EFFECTIVE_DATE_END AND ECM.COMPANY_ID=HPM.COMPANY_ID AND ECM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM EWAY_CURRENCY_MASTER WHERE STATUS='Y' AND CURRENCY_ID=HPM.CURRENCY AND COMPANY_ID=HPM.COMPANY_ID AND SYSDATE() BETWEEN EFFECTIVE_DATE_START AND EFFECTIVE_DATE_END)

MADISON_PT_RISK_DETAILS =SELECT HPM.POLICY_NO POLICY_NO,  MDD.VEHICLE_ID VEHICLE_ID, MDD.VEHICLE_MAKE VEHICLE_MAKE, MDD.VEHCILE_MODEL_DESC VEHCILE_MODEL_DESC, MDD.VEHICLE_TYPE_DESC VEHICLE_TYPE_DESC, MDD.CHASSIS_NUMBER CHASSIS_NUMBER, MDD.REGISTRATION_NUMBER REGISTRATION_NUMBER, MDD.ENGINE_NUMBER ENGINE_NUMBER, MDD.MANUFACTURE_YEAR  MANUFACTURE_YEAR, MDD.SEATING_CAPACITY  SEATING_CAPACITY, PIN.CUSTOMER_REFERENCE_NO  CUSTOMER_CODE, PIN.DOB_OR_REG_DATE  DOB_OR_REG_DATE, MDD.ENDT_PREV_POLICY_NO  PREV_POLICY_NO, MDD.COMPANY_ID  COMPANY_ID, MDD.COLOR_DESC  COLOR_DESC, MDD.POLICY_START_DATE POLICY_START_DATE, MDD.POLICY_END_DATE  POLICY_END_DATE, EBM.CORE_APP_CODE  BRANCH_CODE, HPM.BROKER_CODE  BROKER_CODE, HPM.POLICY_TERM  POLICY_TERM, CPM.CORE_APP_CODE  PRODUCT_CODE, ECM.CORE_APP_CODE  CURRENCY_CODE, HPM.LOGIN_ID  LOGIN_ID, HPM.QUOTE_NO  QUOTE_NO FROM MOTOR_DATA_DETAILS MDD, PERSONAL_INFO PIN, EWAY_BRANCH_MASTER EBM, HOME_POSITION_MASTER HPM, COMPANY_PRODUCT_MASTER CPM, EWAY_CURRENCY_MASTER ECM WHERE MDD.QUOTE_NO=?1 AND MDD.CUSTOMER_ID=PIN.CUSTOMER_ID AND EBM.BRANCH_CODE=HPM.BRANCH_CODE AND EBM.STATUS='Y' AND EBM.COMPANY_ID=HPM.COMPANY_ID AND EBM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM EWAY_BRANCH_MASTER WHERE STATUS='Y' AND BRANCH_CODE=EBM.BRANCH_CODE AND SYSDATE() BETWEEN EFFECTIVE_DATE_START AND EFFECTIVE_DATE_END) AND MDD.POLICY_NO=HPM.POLICY_NO AND HPM.COMPANY_ID=CPM.COMPANY_ID AND HPM.PRODUCT_ID=CPM.PRODUCT_ID AND CPM.STATUS='Y' AND SYSDATE() BETWEEN CPM.EFFECTIVE_DATE_START AND CPM.EFFECTIVE_DATE_END AND CPM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COMPANY_PRODUCT_MASTER WHERE COMPANY_ID = HPM.COMPANY_ID AND PRODUCT_ID = HPM.PRODUCT_ID AND STATUS = 'Y' AND SYSDATE() BETWEEN EFFECTIVE_DATE_START AND EFFECTIVE_DATE_END) AND ECM.STATUS='Y' AND ECM.CURRENCY_ID=HPM.CURRENCY AND SYSDATE() BETWEEN ECM.EFFECTIVE_DATE_START AND ECM.EFFECTIVE_DATE_END AND ECM.COMPANY_ID=HPM.COMPANY_ID AND ECM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM EWAY_CURRENCY_MASTER WHERE STATUS='Y' AND CURRENCY_ID=HPM.CURRENCY AND COMPANY_ID=HPM.COMPANY_ID AND SYSDATE() BETWEEN EFFECTIVE_DATE_START AND EFFECTIVE_DATE_END)

MADISON_PT_COVER_DETAILS =SELECT HPM.POLICY_NO POLICY_NO, PCD.VEHICLE_ID VEHICLE_ID, PCD.COVER_ID COVER_ID, PCD.COVER_NAME COVER_NAME, PCD.COVERAGE_TYPE COVERAGE_TYPE, PCD.SUM_INSURED SUM_INSURED, PCD.RATE RATE, EBM.CORE_APP_CODE  BRANCH_CODE, PCD.PREMIUM_EXCLUDED_TAX_LC PREMIUM_EXCLUDED_TAX_LC, ECM.CORE_APP_CODE  CURRENCY_CODE, CPM.CORE_APP_CODE  PRODUCT_CODE, HPM.LOGIN_ID LOGIN_ID , HPM.QUOTE_NO QUOTE_NO FROM POLICY_COVER_DATA PCD, EWAY_CURRENCY_MASTER ECM, HOME_POSITION_MASTER HPM, COMPANY_PRODUCT_MASTER CPM, EWAY_BRANCH_MASTER EBM WHERE HPM.QUOTE_NO=?1 AND HPM.QUOTE_NO=PCD.QUOTE_NO AND ECM.STATUS='Y' AND ECM.CURRENCY_ID=HPM.CURRENCY AND SYSDATE() BETWEEN ECM.EFFECTIVE_DATE_START AND ECM.EFFECTIVE_DATE_END AND ECM.COMPANY_ID=HPM.COMPANY_ID AND ECM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM EWAY_CURRENCY_MASTER WHERE STATUS='Y' AND CURRENCY_ID=HPM.CURRENCY AND ECM.COMPANY_ID=HPM.COMPANY_ID AND SYSDATE() BETWEEN EFFECTIVE_DATE_START AND EFFECTIVE_DATE_END) AND PCD.COVERAGE_TYPE IN('O','B') AND EBM.BRANCH_CODE=HPM.BRANCH_CODE AND EBM.STATUS='Y' AND EBM.COMPANY_ID=HPM.COMPANY_ID AND EBM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM EWAY_BRANCH_MASTER WHERE STATUS='Y' AND BRANCH_CODE=EBM.BRANCH_CODE AND SYSDATE() BETWEEN EFFECTIVE_DATE_START AND EFFECTIVE_DATE_END) AND HPM.COMPANY_ID=CPM.COMPANY_ID AND HPM.PRODUCT_ID=CPM.PRODUCT_ID AND CPM.STATUS='Y' AND SYSDATE() BETWEEN CPM.EFFECTIVE_DATE_START AND CPM.EFFECTIVE_DATE_END AND CPM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COMPANY_PRODUCT_MASTER WHERE COMPANY_ID = HPM.COMPANY_ID AND PRODUCT_ID = HPM.PRODUCT_ID AND STATUS = 'Y' AND SYSDATE() BETWEEN EFFECTIVE_DATE_START AND EFFECTIVE_DATE_END) 

MADISON_PT_TERMS_DETAILS =SELECT GROUP_CONCAT(TERMS)  TERMS FROM( SELECT CLAUSES_DESCRIPTION  terms FROM CLAUSES_MASTER CM INNER JOIN home_position_master HPM ON CM.COMPANY_ID = HPM.COMPANY_ID AND CM.PRODUCT_ID = HPM.PRODUCT_ID WHERE HPM.QUOTE_NO=?1 AND( CM.BRANCH_CODE = HPM.BRANCH_CODE OR CM.BRANCH_CODE = '99999') AND CM.STATUS = 'Y' AND (SELECT CURRENT_DATE FROM DUAL) BETWEEN CM.EFFECTIVE_DATE_START AND CM.EFFECTIVE_DATE_END AND HPM.QUOTE_NO NOT IN ( SELECT QUOTE_NO FROM terms_and_condition WHERE ID='6' ) UNION SELECT SUB_ID_DESC  terms FROM terms_and_condition CM INNER JOIN home_position_master HPM ON CM.COMPANY_ID = HPM.COMPANY_ID AND CM.PRODUCT_ID = HPM.PRODUCT_ID WHERE HPM.QUOTE_NO=?1 AND HPM.QUOTE_NO IN (CM.QUOTE_NO) AND CM.STATUS = 'Y' AND ( CM.BRANCH_CODE = HPM.BRANCH_CODE OR CM.BRANCH_CODE = '99999' ) AND ID='6' UNION ALL SELECT EXCLUSION_DESCRIPTION  terms FROM EXCLUSION_MASTER CM INNER JOIN home_position_master HPM ON CM.COMPANY_ID = HPM.COMPANY_ID AND CM.PRODUCT_ID = HPM.PRODUCT_ID WHERE HPM.QUOTE_NO=?1 AND ( CM.BRANCH_CODE = HPM.BRANCH_CODE OR CM.BRANCH_CODE = '99999' ) AND CM.STATUS = 'Y' AND (SELECT CURRENT_DATE FROM DUAL) BETWEEN CM.EFFECTIVE_DATE_START AND CM.EFFECTIVE_DATE_END AND HPM.QUOTE_NO NOT IN ( SELECT QUOTE_NO FROM terms_and_condition WHERE ID='7' ) UNION SELECT SUB_ID_DESC  terms FROM terms_and_condition CM INNER JOIN home_position_master HPM ON CM.COMPANY_ID = HPM.COMPANY_ID AND CM.PRODUCT_ID = HPM.PRODUCT_ID WHERE HPM.QUOTE_NO=?1 AND HPM.QUOTE_NO IN (CM.QUOTE_NO) AND CM.STATUS = 'Y' AND ( CM.BRANCH_CODE = HPM.BRANCH_CODE OR CM.BRANCH_CODE = '99999' ) AND ID='7' UNION ALL SELECT WARRANTY_DESCRIPTION  terms FROM WARRANTY_MASTER CM INNER JOIN home_position_master HPM ON CM.COMPANY_ID = HPM.COMPANY_ID AND CM.PRODUCT_ID = HPM.PRODUCT_ID WHERE HPM.QUOTE_NO=?1 AND ( CM.BRANCH_CODE = HPM.BRANCH_CODE OR CM.BRANCH_CODE = '99999' ) AND CM.STATUS = 'Y' AND (SELECT CURRENT_DATE FROM DUAL) BETWEEN CM.EFFECTIVE_DATE_START AND CM.EFFECTIVE_DATE_END AND HPM.QUOTE_NO NOT IN ( SELECT QUOTE_NO FROM terms_and_condition WHERE ID='4' ) UNION SELECT SUB_ID_DESC  terms FROM terms_and_condition CM INNER JOIN home_position_master HPM ON CM.COMPANY_ID = HPM.COMPANY_ID AND CM.PRODUCT_ID = HPM.PRODUCT_ID WHERE HPM.QUOTE_NO=?1 AND HPM.QUOTE_NO IN (CM.QUOTE_NO) AND CM.STATUS = 'Y' AND ( CM.BRANCH_CODE = HPM.BRANCH_CODE OR CM.BRANCH_CODE = '99999' ) AND ID='4')X
 
#Madidon Oracle
MADISON_PT_MAIN_DETAILS_OR =SELECT HPM.POLICY_NO POLICY_NO, HPM.BRANCH_CODE BRANCH_CODE, CPM.CORE_APP_CODE PRODUCT_CODE, HPM.BROKER_CODE BROKER_CODE, HPM.CUSTOMER_NAME CUSTOMER_NAME, PIN.CUSTOMER_REFERENCE_NO CUSTOMER_CODE, PIN.EMAIL_1 EMAIL, ADDRESS_1  ADDRESS, CITY_NAME  CITY_NAME, PIN_CODE PIN_CODE, PIN.MOBILE_NO_1  MOBILE_NO,  HPM.EFFECTIVE_DATE EFFECTIVE_DATE, HPM.EXPIRY_DATE EXPIRY_DATE, HPM.CURRENCY CURRENCY, ECM.CORE_APP_CODE AS CURRENCY_CODE, HPM.EXCHANGE_RATE EXCHANGE_RATE, HPM.POLICY_TERM POLICY_TERM, HPM.LOGIN_ID LOGIN_ID, HPM.QUOTE_NO QUOTE_NO, PIN.POLICY_HOLDER_TYPE_DESC POLICY_HOLDER_TYPE_DESC, PIN.OCCUPATION_DESC OCCUPATION_DESC, PIN.CLIENT_NAME FIRST_NAME, PD.PAYMENT_ID PAYMENT_ID, PD.UPDATED_DATE  PAYMENT_DATE FROM HOME_POSITION_MASTER HPM ,COMPANY_PRODUCT_MASTER CPM, PERSONAL_INFO PIN,EWAY_CURRENCY_MASTER ECM, PAYMENT_DETAIL PD WHERE HPM.QUOTE_NO=?1 AND PD.QUOTE_NO=HPM.QUOTE_NO AND PD.PAYMENT_STATUS='ACCEPTED' AND HPM.COMPANY_ID=CPM.COMPANY_ID AND HPM.PRODUCT_ID=CPM.PRODUCT_ID AND CPM.STATUS='Y' AND SYSDATE BETWEEN CPM.EFFECTIVE_DATE_START AND CPM.EFFECTIVE_DATE_END AND CPM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COMPANY_PRODUCT_MASTER WHERE COMPANY_ID = HPM.COMPANY_ID AND PRODUCT_ID = HPM.PRODUCT_ID AND STATUS = 'Y' AND SYSDATE BETWEEN EFFECTIVE_DATE_START AND EFFECTIVE_DATE_END) AND PIN.CUSTOMER_ID=HPM.CUSTOMER_ID AND ECM.STATUS='Y' AND ECM.CURRENCY_ID=HPM.CURRENCY AND SYSDATE BETWEEN ECM.EFFECTIVE_DATE_START AND ECM.EFFECTIVE_DATE_END AND ECM.COMPANY_ID=HPM.COMPANY_ID AND ECM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM EWAY_CURRENCY_MASTER WHERE STATUS='Y' AND CURRENCY_ID=HPM.CURRENCY AND COMPANY_ID=HPM.COMPANY_ID AND SYSDATE BETWEEN EFFECTIVE_DATE_START AND EFFECTIVE_DATE_END)

MADISON_PT_RISK_DETAILS_OR =SELECT HPM.POLICY_NO POLICY_NO,  MDD.VEHICLE_ID VEHICLE_ID, MDD.VEHICLE_MAKE VEHICLE_MAKE, MDD.VEHCILE_MODEL_DESC VEHCILE_MODEL_DESC, MDD.VEHICLE_TYPE_DESC VEHICLE_TYPE_DESC, MDD.CHASSIS_NUMBER CHASSIS_NUMBER, MDD.REGISTRATION_NUMBER REGISTRATION_NUMBER, MDD.ENGINE_NUMBER ENGINE_NUMBER, MDD.MANUFACTURE_YEAR  MANUFACTURE_YEAR, MDD.SEATING_CAPACITY  SEATING_CAPACITY, PIN.CUSTOMER_REFERENCE_NO  CUSTOMER_CODE, PIN.DOB_OR_REG_DATE  DOB_OR_REG_DATE, MDD.ENDT_PREV_POLICY_NO  PREV_POLICY_NO, MDD.COMPANY_ID  COMPANY_ID, MDD.COLOR_DESC  COLOR_DESC, MDD.POLICY_START_DATE POLICY_START_DATE, MDD.POLICY_END_DATE  POLICY_END_DATE, EBM.CORE_APP_CODE  BRANCH_CODE, HPM.BROKER_CODE  BROKER_CODE, HPM.POLICY_TERM  POLICY_TERM, CPM.CORE_APP_CODE  PRODUCT_CODE, ECM.CORE_APP_CODE  CURRENCY_CODE, HPM.LOGIN_ID  LOGIN_ID, HPM.QUOTE_NO  QUOTE_NO FROM MOTOR_DATA_DETAILS MDD, PERSONAL_INFO PIN, EWAY_BRANCH_MASTER EBM, HOME_POSITION_MASTER HPM, COMPANY_PRODUCT_MASTER CPM, EWAY_CURRENCY_MASTER ECM WHERE MDD.QUOTE_NO=?1 AND MDD.CUSTOMER_ID=PIN.CUSTOMER_ID AND EBM.BRANCH_CODE=HPM.BRANCH_CODE AND EBM.STATUS='Y' AND EBM.COMPANY_ID=HPM.COMPANY_ID AND EBM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM EWAY_BRANCH_MASTER WHERE STATUS='Y' AND BRANCH_CODE=EBM.BRANCH_CODE AND SYSDATE BETWEEN EFFECTIVE_DATE_START AND EFFECTIVE_DATE_END) AND MDD.POLICY_NO=HPM.POLICY_NO AND HPM.COMPANY_ID=CPM.COMPANY_ID AND HPM.PRODUCT_ID=CPM.PRODUCT_ID AND CPM.STATUS='Y' AND SYSDATE BETWEEN CPM.EFFECTIVE_DATE_START AND CPM.EFFECTIVE_DATE_END AND CPM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COMPANY_PRODUCT_MASTER WHERE COMPANY_ID = HPM.COMPANY_ID AND PRODUCT_ID = HPM.PRODUCT_ID AND STATUS = 'Y' AND SYSDATE BETWEEN EFFECTIVE_DATE_START AND EFFECTIVE_DATE_END) AND ECM.STATUS='Y' AND ECM.CURRENCY_ID=HPM.CURRENCY AND SYSDATE BETWEEN ECM.EFFECTIVE_DATE_START AND ECM.EFFECTIVE_DATE_END AND ECM.COMPANY_ID=HPM.COMPANY_ID AND ECM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM EWAY_CURRENCY_MASTER WHERE STATUS='Y' AND CURRENCY_ID=HPM.CURRENCY AND COMPANY_ID=HPM.COMPANY_ID AND SYSDATE BETWEEN EFFECTIVE_DATE_START AND EFFECTIVE_DATE_END)

MADISON_PT_COVER_DETAILS_OR =SELECT HPM.POLICY_NO POLICY_NO, PCD.VEHICLE_ID VEHICLE_ID, PCD.COVER_ID COVER_ID, PCD.COVER_NAME COVER_NAME, PCD.COVERAGE_TYPE COVERAGE_TYPE, PCD.SUM_INSURED SUM_INSURED, PCD.RATE RATE, EBM.CORE_APP_CODE  BRANCH_CODE, PCD.PREMIUM_EXCLUDED_TAX_LC PREMIUM_EXCLUDED_TAX_LC, ECM.CORE_APP_CODE  CURRENCY_CODE, CPM.CORE_APP_CODE  PRODUCT_CODE, HPM.LOGIN_ID LOGIN_ID , HPM.QUOTE_NO QUOTE_NO FROM POLICY_COVER_DATA PCD, EWAY_CURRENCY_MASTER ECM, HOME_POSITION_MASTER HPM, COMPANY_PRODUCT_MASTER CPM, EWAY_BRANCH_MASTER EBM WHERE HPM.QUOTE_NO=?1 AND HPM.QUOTE_NO=PCD.QUOTE_NO AND ECM.STATUS='Y' AND ECM.CURRENCY_ID=HPM.CURRENCY AND SYSDATE BETWEEN ECM.EFFECTIVE_DATE_START AND ECM.EFFECTIVE_DATE_END AND ECM.COMPANY_ID=HPM.COMPANY_ID AND ECM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM EWAY_CURRENCY_MASTER WHERE STATUS='Y' AND CURRENCY_ID=HPM.CURRENCY AND ECM.COMPANY_ID=HPM.COMPANY_ID AND SYSDATE BETWEEN EFFECTIVE_DATE_START AND EFFECTIVE_DATE_END) AND PCD.COVERAGE_TYPE IN('O','B') AND EBM.BRANCH_CODE=HPM.BRANCH_CODE AND EBM.STATUS='Y' AND EBM.COMPANY_ID=HPM.COMPANY_ID AND EBM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM EWAY_BRANCH_MASTER WHERE STATUS='Y' AND BRANCH_CODE=EBM.BRANCH_CODE AND SYSDATE BETWEEN EFFECTIVE_DATE_START AND EFFECTIVE_DATE_END) AND HPM.COMPANY_ID=CPM.COMPANY_ID AND HPM.PRODUCT_ID=CPM.PRODUCT_ID AND CPM.STATUS='Y' AND SYSDATE BETWEEN CPM.EFFECTIVE_DATE_START AND CPM.EFFECTIVE_DATE_END AND CPM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COMPANY_PRODUCT_MASTER WHERE COMPANY_ID = HPM.COMPANY_ID AND PRODUCT_ID = HPM.PRODUCT_ID AND STATUS = 'Y' AND SYSDATE BETWEEN EFFECTIVE_DATE_START AND EFFECTIVE_DATE_END)    

MADISON_PT_TERMS_DETAILS_OR =SELECT GROUP_CONCAT(TERMS)  TERMS FROM( SELECT CLAUSES_DESCRIPTION  terms FROM CLAUSES_MASTER CM INNER JOIN home_position_master HPM ON CM.COMPANY_ID = HPM.COMPANY_ID AND CM.PRODUCT_ID = HPM.PRODUCT_ID WHERE HPM.QUOTE_NO=?1 AND( CM.BRANCH_CODE = HPM.BRANCH_CODE OR CM.BRANCH_CODE = '99999') AND CM.STATUS = 'Y' AND (SELECT CURRENT_DATE FROM DUAL) BETWEEN CM.EFFECTIVE_DATE_START AND CM.EFFECTIVE_DATE_END AND HPM.QUOTE_NO NOT IN ( SELECT QUOTE_NO FROM terms_and_condition WHERE ID='6' ) UNION SELECT SUB_ID_DESC  terms FROM terms_and_condition CM INNER JOIN home_position_master HPM ON CM.COMPANY_ID = HPM.COMPANY_ID AND CM.PRODUCT_ID = HPM.PRODUCT_ID WHERE HPM.QUOTE_NO=?1 AND HPM.QUOTE_NO IN (CM.QUOTE_NO) AND CM.STATUS = 'Y' AND ( CM.BRANCH_CODE = HPM.BRANCH_CODE OR CM.BRANCH_CODE = '99999' ) AND ID='6' UNION ALL SELECT EXCLUSION_DESCRIPTION  terms FROM EXCLUSION_MASTER CM INNER JOIN home_position_master HPM ON CM.COMPANY_ID = HPM.COMPANY_ID AND CM.PRODUCT_ID = HPM.PRODUCT_ID WHERE HPM.QUOTE_NO=?1 AND ( CM.BRANCH_CODE = HPM.BRANCH_CODE OR CM.BRANCH_CODE = '99999' ) AND CM.STATUS = 'Y' AND (SELECT CURRENT_DATE FROM DUAL) BETWEEN CM.EFFECTIVE_DATE_START AND CM.EFFECTIVE_DATE_END AND HPM.QUOTE_NO NOT IN ( SELECT QUOTE_NO FROM terms_and_condition WHERE ID='7' ) UNION SELECT SUB_ID_DESC  terms FROM terms_and_condition CM INNER JOIN home_position_master HPM ON CM.COMPANY_ID = HPM.COMPANY_ID AND CM.PRODUCT_ID = HPM.PRODUCT_ID WHERE HPM.QUOTE_NO=?1 AND HPM.QUOTE_NO IN (CM.QUOTE_NO) AND CM.STATUS = 'Y' AND ( CM.BRANCH_CODE = HPM.BRANCH_CODE OR CM.BRANCH_CODE = '99999' ) AND ID='7' UNION ALL SELECT WARRANTY_DESCRIPTION  terms FROM WARRANTY_MASTER CM INNER JOIN home_position_master HPM ON CM.COMPANY_ID = HPM.COMPANY_ID AND CM.PRODUCT_ID = HPM.PRODUCT_ID WHERE HPM.QUOTE_NO=?1 AND ( CM.BRANCH_CODE = HPM.BRANCH_CODE OR CM.BRANCH_CODE = '99999' ) AND CM.STATUS = 'Y' AND (SELECT CURRENT_DATE FROM DUAL) BETWEEN CM.EFFECTIVE_DATE_START AND CM.EFFECTIVE_DATE_END AND HPM.QUOTE_NO NOT IN ( SELECT QUOTE_NO FROM terms_and_condition WHERE ID='4' ) UNION SELECT SUB_ID_DESC  terms FROM terms_and_condition CM INNER JOIN home_position_master HPM ON CM.COMPANY_ID = HPM.COMPANY_ID AND CM.PRODUCT_ID = HPM.PRODUCT_ID WHERE HPM.QUOTE_NO=?1 AND HPM.QUOTE_NO IN (CM.QUOTE_NO) AND CM.STATUS = 'Y' AND ( CM.BRANCH_CODE = HPM.BRANCH_CODE OR CM.BRANCH_CODE = '99999' ) AND ID='4')X
