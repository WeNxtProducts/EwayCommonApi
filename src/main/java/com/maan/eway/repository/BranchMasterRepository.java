/*
 * Java domain class for entity "BranchMaster" 
 * Created on 2022-08-24 ( Date ISO 2022-08-24 - Time 12:58:27 )
 * Generated by Telosys Tools Generator ( version 3.3.0 )
 */
 
 /*
 * Created on 2022-08-24 ( 12:58:27 )
 * Generated by Telosys ( http://www.telosys.org/ ) version 3.3.0
 */


package com.maan.eway.repository;

import java.util.List;
import java.util.Map;

import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.JpaSpecificationExecutor;
import org.springframework.data.jpa.repository.Query;

import com.maan.eway.bean.BranchMaster;
import com.maan.eway.bean.BranchMasterId;
/**
 * <h2>BranchMasterRepository</h2>
 *
 * createdAt : 2022-08-24 - Time 12:58:27
 * <p>
 * Description: "BranchMaster" Repository
 */
 
 
 
public interface BranchMasterRepository  extends JpaRepository<BranchMaster,BranchMasterId > , JpaSpecificationExecutor<BranchMaster> {

	List<BranchMaster> findByBranchCodeInOrderByBranchCodeAsc(List<String> branchList);

	Long countByBranchNameOrderByEntryDateDesc(String branchName);

	List<BranchMaster> findTopByCompanyIdAndBranchCodeOrderByAmendIdDesc(String companyId, String branchCode);

//	@Query(value="SELECT HPM.LOGIN_ID, HPM.QUOTE_NO, HPM.POLICY_NO, UPPER( CONCAT( CONCAT(PIF.TITLE_DESC, '.'), PIF.CLIENT_NAME) ) AS CUSTOMER_NAME, HPM.inception_date AS START_DATE, HPM.expiry_date AS END_DATE, HPM.effective_date AS ISSUE_DATE, UPPER(HPM.BRANCH_NAME) AS BRANCH_NAME, CASE WHEN HPM.SOURCE_TYPE IN( 'Premia Broker', 'Premia Direct', 'Premia Agent' ) THEN HPM.CUSTOMER_NAME ELSE( SELECT UPPER(USER_NAME) FROM login_user_info WHERE LOGIN_ID = HPM.LOGIN_ID ) END AS BROKER_NAME, HPM.USER_TYPE AS USER_TYPE, HPM.SUB_USER_TYPE AS SUB_USER_TYPE, HPM.CURRENCY, HPM.PAYMENT_TYPE, ( SELECT PAYMENT_ID FROM PAYMENT_INFO WHERE QUOTE_NO = HPM.QUOTE_NO AND payment_status = 'ACCEPTED' ) AS PAYMENT_ID, HPM.PRODUCT_NAME, CASE WHEN HPM.PRODUCT_ID = '4' THEN ( SELECT DISTINCT SECTION_NAME FROM TRAVEL_PASSENGER_DETAILS WHERE QUOTE_NO = HPM.QUOTE_NO ) WHEN HPM.PRODUCT_ID = '5' THEN (SELECT POLICY_TYPE_DESC FROM MOTOR_DATA_DETAILS WHERE QUOTE_NO=HPM.QUOTE_NO AND VEHICLE_ID='1') ELSE ( SELECT POLICY_TYPE_NAME FROM POLICY_TYPE_MASTER WHERE STATUS = 'Y' AND PRODUCT_ID = HPM.PRODUCT_ID AND COMPANY_ID = HPM.COMPANY_ID AND AMEND_ID = ( SELECT MAX(AMEND_ID) FROM POLICY_TYPE_MASTER WHERE STATUS = 'Y' AND PRODUCT_ID = HPM.PRODUCT_ID AND COMPANY_ID = HPM.COMPANY_ID ) ) END AS POLICY_TYPE_DESC, HPM.DEBIT_NOTE_NO, ( SELECT SUM(SUM_INSURED) FROM POLICY_COVER_DATA WHERE QUOTE_NO = HPM.QUOTE_NO AND TAX_ID = '0' AND DISC_LOAD_ID = '0' AND COVERAGE_TYPE = 'B' ) AS SUM_INSURED, CASE WHEN HPM.CURRENCY IN ( SELECT CURRENCY_ID FROM EWAY_INSURANCE_COMPANY_MASTER WHERE HPM.COMPANY_ID = COMPANY_ID ) THEN ROUND(HPM.OVERALL_PREMIUM_LC, 2) ELSE ROUND(HPM.OVERALL_PREMIUM_FC, 2) END AS PERMIUM, ROUND(HPM.COMMISSION_PERCENTAGE, 1) AS COMMISSION_PERCENTAGE, ROUND(COMMISSION, 2) AS COMMISSION_AMOUNT FROM HOME_POSITION_MASTER HPM, PERSONAL_INFO PIF WHERE HPM.CUSTOMER_ID = PIF.CUSTOMER_ID AND HPM.PRODUCT_ID = ?1 AND ( CASE WHEN '99999' = ?2 THEN '1' ELSE HPM.BRANCH_CODE END ) = ( CASE WHEN '99999' = ?2 THEN '1' ELSE ?2 END ) AND HPM.STATUS = 'P' AND HPM.POLICY_NO IS NOT NULL AND REGEXP_SUBSTR(HPM.EFFECTIVE_DATE,'[^ ]+') BETWEEN ?3 AND ?4"
//			+ " AND ( ( CASE WHEN ( SELECT SUB_USER_TYPE FROM eway_login_master WHERE LOGIN_ID = ?5 ) IN ('both') THEN '1' WHEN ( SELECT SUB_USER_TYPE FROM eway_login_master WHERE LOGIN_ID = ?5 ) IN ('low', 'high') THEN HPM.Application_id END ) = ( CASE WHEN ( SELECT SUB_USER_TYPE FROM eway_login_master WHERE LOGIN_ID = ?5 ) IN ('both') THEN '1' ELSE ?5 END ) OR ( CASE WHEN ( SELECT USER_TYPE FROM eway_login_master WHERE LOGIN_ID = ?5 )= 'Broker' THEN HPM.AGENCY_CODE END ) IN ( SELECT DISTINCT AGENCY_CODE FROM eway_login_master WHERE OA_CODE IN ( SELECT AGENCY_CODE FROM eway_login_master WHERE LOGIN_ID = ?5 ) ) OR HPM.AGENCY_CODE IN ( SELECT AGENCY_CODE FROM eway_login_master WHERE LOGIN_ID = ?5 )) ORDER BY EFFECTIVE_DATE DESC ",nativeQuery=true)	
//	List<Map<String,Object>> getPremiumReportDetails(String productId,String branchCode,String startDate,String endDate,String loginId);
//	
	
//	@Query(nativeQuery=true,value="SELECT HPM.ORIGINAL_POLICY_NO, SOURCE_TYPE, HPM.CUSTOMER_CODE, HPM.LOGIN_ID, HPM.QUOTE_NO, HPM.POLICY_NO, UPPER( CONCAT( CONCAT(PIF.TITLE_DESC, '.'), PIF.CLIENT_NAME) ) AS CUSTOMER_NAME, HPM.inception_date AS START_DATE, HPM.expiry_date AS END_DATE, HPM.effective_date AS ISSUE_DATE, UPPER(HPM.BRANCH_NAME) AS BRANCH_NAME, CASE WHEN HPM.SOURCE_TYPE IN( 'Premia Broker', 'Premia Direct', 'Premia Agent' ) THEN HPM.CUSTOMER_NAME ELSE( SELECT UPPER(USER_NAME) FROM login_user_info WHERE LOGIN_ID = HPM.LOGIN_ID ) END AS BROKER_NAME, HPM.USER_TYPE AS USER_TYPE, HPM.SUB_USER_TYPE AS SUB_USER_TYPE, HPM.CURRENCY, HPM.PAYMENT_TYPE,( SELECT PAYMENT_ID FROM PAYMENT_INFO WHERE QUOTE_NO = HPM.QUOTE_NO AND payment_status = 'ACCEPTED' ) AS PAYMENT_ID, HPM.PRODUCT_NAME, CASE WHEN HPM.PRODUCT_ID = '4' THEN ( SELECT DISTINCT SECTION_NAME FROM TRAVEL_PASSENGER_DETAILS WHERE QUOTE_NO = HPM.QUOTE_NO ) WHEN HPM.PRODUCT_ID = '5' THEN ( SELECT POLICY_TYPE_DESC FROM MOTOR_DATA_DETAILS WHERE QUOTE_NO = HPM.QUOTE_NO AND VEHICLE_ID = '1' ) ELSE ( SELECT POLICY_TYPE_NAME FROM POLICY_TYPE_MASTER WHERE STATUS = 'Y' AND PRODUCT_ID = HPM.PRODUCT_ID AND COMPANY_ID = HPM.COMPANY_ID AND AMEND_ID = ( SELECT MAX(AMEND_ID) FROM POLICY_TYPE_MASTER WHERE STATUS = 'Y' AND PRODUCT_ID = HPM.PRODUCT_ID AND COMPANY_ID = HPM.COMPANY_ID ) ) END AS POLICY_TYPE_DESC, HPM.DEBIT_NOTE_NO, ( SELECT SUM(SUM_INSURED) FROM POLICY_COVER_DATA WHERE QUOTE_NO = HPM.QUOTE_NO AND TAX_ID = '0' AND DISC_LOAD_ID = '0' AND COVERAGE_TYPE = 'B' ) AS SUM_INSURED, CASE WHEN HPM.CURRENCY IN ( SELECT CURRENCY_ID FROM EWAY_INSURANCE_COMPANY_MASTER WHERE HPM.COMPANY_ID = COMPANY_ID ) THEN ROUND(HPM.OVERALL_PREMIUM_LC, 2) ELSE ROUND(HPM.OVERALL_PREMIUM_FC, 2) END AS PERMIUM, ROUND(HPM.COMMISSION_PERCENTAGE, 1) AS COMMISSION_PERCENTAGE, ROUND(COMMISSION, 2) AS COMMISSION_AMOUNT, ( CASE WHEN UPPER(HPM.PAYMENT_TYPE)= UPPER('Credit') THEN( ( SELECT ( COALESCE(DEPOSIT_AMOUNT, 0) - COALESCE(DEPOSIT_UTILISED, 0) + COALESCE(REFUND_AMOUNT, 0) ) FROM EWAY_DEPOSIT_CBC_MASTER WHERE BROKER_ID = HPM.BROKER_CODE ) ) ELSE '' END ) AS CREDIT_LIMIT FROM HOME_POSITION_MASTER HPM, PERSONAL_INFO PIF WHERE HPM.CUSTOMER_ID = PIF.CUSTOMER_ID AND HPM.PRODUCT_ID = ?1 AND ( CASE WHEN '99999' = ?2 THEN '1' ELSE HPM.BRANCH_CODE END ) = ( CASE WHEN '99999' = ?2 THEN '1' ELSE ?2 END ) AND HPM.STATUS = 'P' AND HPM.POLICY_NO IS NOT NULL AND REGEXP_SUBSTR(HPM.EFFECTIVE_DATE, '[^ ]+') BETWEEN ?3 AND ?4 AND ( ( CASE WHEN ( SELECT SUB_USER_TYPE FROM eway_login_master WHERE LOGIN_ID = ?5 ) IN ('SuperAdmin') THEN '1' WHEN ( SELECT SUB_USER_TYPE FROM eway_login_master WHERE LOGIN_ID = ?5 ) IN ('low', 'high', 'both') THEN HPM.Application_id END ) = ( CASE WHEN ( SELECT SUB_USER_TYPE FROM eway_login_master WHERE LOGIN_ID = ?5 ) IN ('SuperAdmin') THEN '1' ELSE ?5 END ) OR ( CASE WHEN ( SELECT USER_TYPE FROM eway_login_master WHERE LOGIN_ID = ?5 )= 'Broker' THEN HPM.AGENCY_CODE END ) IN ( SELECT DISTINCT AGENCY_CODE FROM eway_login_master WHERE OA_CODE IN ( SELECT AGENCY_CODE FROM eway_login_master WHERE LOGIN_ID = ?5 ) ) OR HPM.AGENCY_CODE IN ( SELECT AGENCY_CODE FROM eway_login_master WHERE LOGIN_ID = ?5 ) ) AND ( CASE WHEN '99999' = ?6 THEN '1' WHEN ?6 IN( 'Premia Broker', 'Premia Direct', 'Premia Agent' ) THEN HPM.CUSTOMER_CODE ELSE LOGIN_ID END ) = ( CASE WHEN '99999' = ?6 THEN '1' WHEN ?6 IN( 'Premia Broker', 'Premia Direct', 'Premia Agent' ) THEN ?7 ELSE ?7 END ) ORDER BY HPM.EFFECTIVE_DATE DESC")
//	List<Map<String,Object>> getPremiumReportDetails(String productId,String branchCode,String startDate,String endDate,String loginId,String userType,String code);
	
    @Query(value="SELECT HPM.ORIGINAL_POLICY_NO, HPM.SOURCE_TYPE, HPM.CUSTOMER_CODE, HPM.LOGIN_ID, HPM.QUOTE_NO, HPM.POLICY_NO, UPPER(PIF.TITLE_DESC || '.' || PIF.CLIENT_NAME) AS CUSTOMER_NAME, HPM.inception_date AS START_DATE, HPM.expiry_date AS END_DATE, HPM.entry_date AS ISSUE_DATE, UPPER(HPM.BRANCH_NAME) AS BRANCH_NAME, CASE WHEN HPM.SOURCE_TYPE IN ('Premia Broker', 'Premia Direct', 'Premia Agent') THEN HPM.CUSTOMER_NAME ELSE (SELECT UPPER(USER_NAME) FROM login_user_info WHERE LOGIN_ID = HPM.LOGIN_ID) END AS BROKER_NAME, HPM.USER_TYPE AS USER_TYPE, HPM.SUB_USER_TYPE AS SUB_USER_TYPE, HPM.CURRENCY, HPM.PAYMENT_TYPE, (SELECT PAYMENT_ID FROM PAYMENT_INFO WHERE QUOTE_NO = HPM.QUOTE_NO AND payment_status = 'ACCEPTED' FETCH FIRST 1 ROW ONLY) AS PAYMENT_ID, HPM.PRODUCT_NAME, CASE WHEN HPM.PRODUCT_ID = '4' THEN (SELECT DISTINCT SECTION_NAME FROM TRAVEL_PASSENGER_DETAILS WHERE QUOTE_NO = HPM.QUOTE_NO) WHEN HPM.PRODUCT_ID = '5' THEN (SELECT POLICY_TYPE_DESC FROM MOTOR_DATA_DETAILS WHERE QUOTE_NO = HPM.QUOTE_NO AND VEHICLE_ID = '1') ELSE (SELECT POLICY_TYPE_NAME FROM POLICY_TYPE_MASTER WHERE STATUS = 'Y' AND PRODUCT_ID = HPM.PRODUCT_ID AND COMPANY_ID = HPM.COMPANY_ID AND AMEND_ID = (SELECT MAX(AMEND_ID) FROM POLICY_TYPE_MASTER WHERE STATUS = 'Y' AND PRODUCT_ID = HPM.PRODUCT_ID AND COMPANY_ID = HPM.COMPANY_ID)) END AS POLICY_TYPE_DESC, HPM.DEBIT_NOTE_NO, (SELECT SUM(SUM_INSURED) FROM POLICY_COVER_DATA WHERE QUOTE_NO = HPM.QUOTE_NO AND TAX_ID = '0' AND DISC_LOAD_ID = '0' AND COVERAGE_TYPE = 'B') AS SUM_INSURED, CASE WHEN HPM.CURRENCY IN (SELECT CURRENCY_ID FROM EWAY_INSURANCE_COMPANY_MASTER WHERE HPM.COMPANY_ID = COMPANY_ID) THEN (CASE WHEN HPM.PRODUCT_ID IN ('5', '46') THEN MDD.OVERALL_PREMIUM_LC ELSE ROUND(HPM.OVERALL_PREMIUM_LC) END) ELSE (CASE WHEN HPM.PRODUCT_ID IN ('5', '46') THEN MDD.OVERALL_PREMIUM_FC ELSE ROUND(HPM.OVERALL_PREMIUM_FC) END) END AS PREMIUM, ROUND(HPM.COMMISSION_PERCENTAGE, 1) AS COMMISSION_PERCENTAGE, ROUND(COMMISSION, 2) AS COMMISSION_AMOUNT, CASE WHEN UPPER(HPM.PAYMENT_TYPE) = UPPER('Credit') THEN (SELECT COALESCE(DEPOSIT_AMOUNT, 0) - COALESCE(DEPOSIT_UTILISED, 0) + COALESCE(REFUND_AMOUNT, 0) FROM EWAY_DEPOSIT_CBC_MASTER WHERE BROKER_ID = HPM.BROKER_CODE) ELSE NULL END AS CREDIT_LIMIT FROM HOME_POSITION_MASTER HPM JOIN PERSONAL_INFO PIF ON HPM.CUSTOMER_ID = PIF.CUSTOMER_ID LEFT JOIN SECTION_DATA_DETAILS SDD ON HPM.QUOTE_NO = SDD.QUOTE_NO LEFT JOIN MOTOR_DATA_DETAILS MDD ON SDD.QUOTE_NO = MDD.QUOTE_NO AND SDD.RISK_ID = MDD.VEHICLE_ID WHERE HPM.QUOTE_NO = SDD.QUOTE_NO AND HPM.PRODUCT_ID = ?1 AND (CASE WHEN '99999' = ?2 THEN '1' ELSE HPM.BRANCH_CODE END) = (CASE WHEN '99999' = ?2 THEN '1' ELSE ?2 END) AND HPM.STATUS = 'P' AND HPM.POLICY_NO IS NOT NULL AND REGEXP_SUBSTR(HPM.EFFECTIVE_DATE, '[^ ]+') BETWEEN ?3 AND ?4 AND ( (CASE WHEN (SELECT SUB_USER_TYPE FROM eway_login_master WHERE LOGIN_ID = ?5) IN ('both', 'high') THEN '1' WHEN (SELECT SUB_USER_TYPE FROM eway_login_master WHERE LOGIN_ID = ?5) IN ('high') THEN HPM.Application_id END) = (CASE WHEN (SELECT SUB_USER_TYPE FROM eway_login_master WHERE LOGIN_ID = ?5) IN ('both', 'high') THEN '1' ELSE 'approver1' END) OR (CASE WHEN (SELECT USER_TYPE FROM eway_login_master WHERE LOGIN_ID = ?5) = 'Broker' THEN HPM.AGENCY_CODE END) IN (SELECT DISTINCT AGENCY_CODE FROM eway_login_master WHERE OA_CODE IN (SELECT AGENCY_CODE FROM eway_login_master WHERE LOGIN_ID = ?5)) OR HPM.AGENCY_CODE IN (SELECT AGENCY_CODE FROM eway_login_master WHERE LOGIN_ID = ?5) ) AND (CASE WHEN '99999' = ?6 THEN '1' WHEN ?6 IN ('Premia Broker', 'Premia Direct', 'Premia Agent') THEN HPM.CUSTOMER_CODE ELSE HPM.LOGIN_ID END) = (CASE WHEN '99999' = ?6 THEN '1' WHEN ?6 IN ('Premia Broker', 'Premia Direct', 'Premia Agent') THEN ?7 ELSE ?7 END) ORDER BY HPM.EFFECTIVE_DATE DESC",nativeQuery=true)
	List<Map<String,Object>> getPremiumReportDetails(String productId,String branchCode,String startDate,String endDate,String loginId,String userType,String code);
    
    @Query(value="SELECT HPM.ORIGINAL_POLICY_NO, HPM.SOURCE_TYPE, HPM.CUSTOMER_CODE, HPM.LOGIN_ID, HPM.QUOTE_NO, HPM.POLICY_NO, UPPER( CONCAT( CONCAT(PIF.TITLE_DESC, '.'), PIF.CLIENT_NAME ) ) AS CUSTOMER_NAME, HPM.inception_date AS START_DATE, HPM.expiry_date AS END_DATE, HPM.entry_date AS ISSUE_DATE, UPPER(HPM.BRANCH_NAME) AS BRANCH_NAME, CASE WHEN HPM.SOURCE_TYPE IN( 'Premia Broker', 'Premia Direct', 'Premia Agent' ) THEN HPM.CUSTOMER_NAME ELSE( SELECT UPPER(USER_NAME) FROM login_user_info WHERE LOGIN_ID = HPM.LOGIN_ID ) END AS BROKER_NAME, HPM.USER_TYPE AS USER_TYPE, HPM.SUB_USER_TYPE AS SUB_USER_TYPE, HPM.CURRENCY, HPM.PAYMENT_TYPE, ( SELECT PAYMENT_ID FROM PAYMENT_INFO WHERE QUOTE_NO = HPM.QUOTE_NO AND payment_status = 'ACCEPTED' LIMIT 1 ) AS PAYMENT_ID, HPM.PRODUCT_NAME, CASE WHEN HPM.PRODUCT_ID = '4' THEN ( SELECT DISTINCT SECTION_NAME FROM TRAVEL_PASSENGER_DETAILS WHERE QUOTE_NO = HPM.QUOTE_NO ) WHEN HPM.PRODUCT_ID = '5' THEN ( SELECT POLICY_TYPE_DESC FROM MOTOR_DATA_DETAILS WHERE QUOTE_NO = HPM.QUOTE_NO AND VEHICLE_ID = '1' ) ELSE ( SELECT POLICY_TYPE_NAME FROM POLICY_TYPE_MASTER WHERE STATUS = 'Y' AND PRODUCT_ID = HPM.PRODUCT_ID AND COMPANY_ID = HPM.COMPANY_ID AND AMEND_ID = ( SELECT MAX(AMEND_ID) FROM POLICY_TYPE_MASTER WHERE STATUS = 'Y' AND PRODUCT_ID = HPM.PRODUCT_ID AND COMPANY_ID = HPM.COMPANY_ID ) ) END AS POLICY_TYPE_DESC, HPM.DEBIT_NOTE_NO, ( SELECT SUM(SUM_INSURED) FROM POLICY_COVER_DATA WHERE QUOTE_NO = HPM.QUOTE_NO AND TAX_ID = '0' AND DISC_LOAD_ID = '0' AND COVERAGE_TYPE = 'B' ) AS SUM_INSURED, CASE WHEN HPM.CURRENCY IN ( SELECT CURRENCY_ID FROM EWAY_INSURANCE_COMPANY_MASTER WHERE HPM.COMPANY_ID = COMPANY_ID ) THEN (CASE WHEN HPM.PRODUCT_ID IN ('5','46') THEN MDD.OVERALL_PREMIUM_LC ELSE ROUND(HPM.OVERALL_PREMIUM_LC )END) ELSE (CASE WHEN HPM.PRODUCT_ID IN ('5','46') THEN MDD.OVERALL_PREMIUM_FC ELSE ROUND(HPM.OVERALL_PREMIUM_FC )END) END AS PERMIUM, ROUND(HPM.COMMISSION_PERCENTAGE, 1) AS COMMISSION_PERCENTAGE, ROUND(COMMISSION, 2) AS COMMISSION_AMOUNT, ( CASE WHEN UPPER(HPM.PAYMENT_TYPE)= UPPER('Credit') THEN( ( SELECT ( COALESCE(DEPOSIT_AMOUNT, 0) - COALESCE(DEPOSIT_UTILISED, 0) + COALESCE(REFUND_AMOUNT, 0) ) FROM EWAY_DEPOSIT_CBC_MASTER WHERE BROKER_ID = HPM.BROKER_CODE ) ) ELSE '' END ) AS CREDIT_LIMIT FROM HOME_POSITION_MASTER HPM, PERSONAL_INFO PIF,SECTION_DATA_DETAILS SDD LEFT JOIN MOTOR_DATA_DETAILS MDD ON SDD.QUOTE_NO = MDD.QUOTE_NO AND SDD.RISK_ID=MDD.VEHICLE_ID WHERE HPM.QUOTE_NO=SDD.QUOTE_NO AND HPM.CUSTOMER_ID = PIF.CUSTOMER_ID AND HPM.PRODUCT_ID = ?1 AND ( CASE WHEN '99999' = ?2 THEN '1' ELSE HPM.BRANCH_CODE END ) = ( CASE WHEN '99999' = ?2 THEN '1' ELSE ?2 END ) AND HPM.STATUS = 'P' AND HPM.POLICY_NO IS NOT NULL AND REGEXP_SUBSTR(HPM.EFFECTIVE_DATE, '[^ ]+') BETWEEN ?3 AND ?4 AND ( ( CASE WHEN ( SELECT SUB_USER_TYPE FROM eway_login_master WHERE LOGIN_ID = ?5 ) IN ('both', 'high') THEN '1' WHEN ( SELECT SUB_USER_TYPE FROM eway_login_master WHERE LOGIN_ID = ?5 ) IN ('high') THEN HPM.Application_id END ) = ( CASE WHEN ( SELECT SUB_USER_TYPE FROM eway_login_master WHERE LOGIN_ID = ?5 ) IN ('both', 'high') THEN '1' ELSE 'approver1' END ) OR ( CASE WHEN ( SELECT USER_TYPE FROM eway_login_master WHERE LOGIN_ID = ?5 )= 'Broker' THEN HPM.AGENCY_CODE END ) IN ( SELECT DISTINCT AGENCY_CODE FROM eway_login_master WHERE OA_CODE IN ( SELECT AGENCY_CODE FROM eway_login_master WHERE LOGIN_ID = ?5 ) ) OR HPM.AGENCY_CODE IN ( SELECT AGENCY_CODE FROM eway_login_master WHERE LOGIN_ID = ?5 ) ) AND ( CASE WHEN '99999' = ?6 THEN '1' WHEN ?6 IN( 'Premia Broker', 'Premia Direct', 'Premia Agent' ) THEN HPM.CUSTOMER_CODE ELSE HPM.LOGIN_ID END ) = ( CASE WHEN '99999' = ?6 THEN '1' WHEN ?6 IN( 'Premia Broker', 'Premia Direct', 'Premia Agent' ) THEN ?7 ELSE ?7 END ) ORDER BY HPM.EFFECTIVE_DATE DESC",nativeQuery=true)
	List<Map<String,Object>> getPremiumReportDetailsSql(String productId,String branchCode,String startDate,String endDate,String loginId,String userType,String code);
    
    @Query(value="SELECT HPM.ORIGINAL_POLICY_NO, SOURCE_TYPE, HPM.CUSTOMER_CODE, HPM.LOGIN_ID, HPM.QUOTE_NO, HPM.POLICY_NO, UPPER( CONCAT( CONCAT(PIF.TITLE_DESC, '.'), PIF.CLIENT_NAME ) ) AS CUSTOMER_NAME, HPM.inception_date AS START_DATE, HPM.expiry_date AS END_DATE, HPM.effective_date AS ISSUE_DATE, UPPER(HPM.BRANCH_NAME) AS BRANCH_NAME, CASE WHEN HPM.SOURCE_TYPE IN( 'Premia Broker', 'Premia Direct', 'Premia Agent' ) THEN HPM.CUSTOMER_NAME ELSE( SELECT UPPER(USER_NAME) FROM login_user_info WHERE LOGIN_ID = HPM.LOGIN_ID ) END AS BROKER_NAME, HPM.USER_TYPE AS USER_TYPE, HPM.SUB_USER_TYPE AS SUB_USER_TYPE, HPM.CURRENCY, HPM.PAYMENT_TYPE, ( SELECT PAYMENT_ID FROM PAYMENT_INFO WHERE QUOTE_NO = HPM.QUOTE_NO AND payment_status = 'ACCEPTED' ) AS PAYMENT_ID, HPM.PRODUCT_NAME, CASE WHEN HPM.PRODUCT_ID = '4' THEN ( SELECT DISTINCT SECTION_NAME FROM TRAVEL_PASSENGER_DETAILS WHERE QUOTE_NO = HPM.QUOTE_NO ) WHEN HPM.PRODUCT_ID = '5' THEN ( SELECT POLICY_TYPE_DESC FROM MOTOR_DATA_DETAILS WHERE QUOTE_NO = HPM.QUOTE_NO AND VEHICLE_ID = '1' ) ELSE ( SELECT POLICY_TYPE_NAME FROM POLICY_TYPE_MASTER WHERE STATUS = 'Y' AND PRODUCT_ID = HPM.PRODUCT_ID AND COMPANY_ID = HPM.COMPANY_ID AND AMEND_ID = ( SELECT MAX(AMEND_ID) FROM POLICY_TYPE_MASTER WHERE STATUS = 'Y' AND PRODUCT_ID = HPM.PRODUCT_ID AND COMPANY_ID = HPM.COMPANY_ID ) ) END AS POLICY_TYPE_DESC, HPM.DEBIT_NOTE_NO, ( SELECT SUM(SUM_INSURED) FROM POLICY_COVER_DATA WHERE QUOTE_NO = HPM.QUOTE_NO AND TAX_ID = '0' AND DISC_LOAD_ID = '0' AND COVERAGE_TYPE = 'B' ) AS SUM_INSURED, CASE WHEN HPM.CURRENCY IN ( SELECT CURRENCY_ID FROM EWAY_INSURANCE_COMPANY_MASTER WHERE HPM.COMPANY_ID = COMPANY_ID ) THEN ROUND(HPM.OVERALL_PREMIUM_LC, 2) ELSE ROUND(HPM.OVERALL_PREMIUM_FC, 2) END AS PERMIUM, ROUND(HPM.COMMISSION_PERCENTAGE, 1) AS COMMISSION_PERCENTAGE, ROUND(COMMISSION, 2) AS COMMISSION_AMOUNT,  (CASE WHEN UPPER(HPM.PAYMENT_TYPE)=UPPER('Credit') THEN( (SELECT (COALESCE(DEPOSIT_AMOUNT,0) - COALESCE(DEPOSIT_UTILISED,0) + COALESCE(REFUND_AMOUNT,0)) FROM EWAY_DEPOSIT_CBC_MASTER WHERE BROKER_ID = HPM.BROKER_CODE)) ELSE '' END) AS CREDIT_LIMIT FROM HOME_POSITION_MASTER HPM, PERSONAL_INFO PIF WHERE HPM.CUSTOMER_ID = PIF.CUSTOMER_ID AND HPM.PRODUCT_ID = ?1 AND ( CASE WHEN '99999' = ?2 THEN '1' ELSE HPM.BRANCH_CODE END ) = ( CASE WHEN '99999' = ?2 THEN '1' ELSE ?2 END ) AND HPM.STATUS = 'P' AND HPM.POLICY_NO IS NOT NULL AND REGEXP_SUBSTR(HPM.EFFECTIVE_DATE, '[^ ]+') BETWEEN ?3 AND ?4 AND ( ( CASE WHEN ( SELECT SUB_USER_TYPE FROM eway_login_master WHERE LOGIN_ID = ?5 ) IN ('both') THEN '1' WHEN ( SELECT SUB_USER_TYPE FROM eway_login_master WHERE LOGIN_ID = ?5 ) IN ('low', 'high') THEN HPM.Application_id END ) = ( CASE WHEN ( SELECT SUB_USER_TYPE FROM eway_login_master WHERE LOGIN_ID = ?5 ) IN ('both') THEN '1' ELSE 'approver1' END ) OR ( CASE WHEN ( SELECT USER_TYPE FROM eway_login_master WHERE LOGIN_ID = ?5 )= 'Broker' THEN HPM.AGENCY_CODE END ) IN ( SELECT DISTINCT AGENCY_CODE FROM eway_login_master WHERE OA_CODE IN ( SELECT AGENCY_CODE FROM eway_login_master WHERE LOGIN_ID = ?5 ) ) OR HPM.AGENCY_CODE IN ( SELECT AGENCY_CODE FROM eway_login_master WHERE LOGIN_ID = ?5 ) ) AND ( CASE WHEN '99999' = ?6 THEN '1' WHEN ?6 IN( 'Premia Broker', 'Premia Direct', 'Premia Agent' ) THEN HPM.CUSTOMER_CODE ELSE LOGIN_ID END ) = ( CASE WHEN '99999' = ?6 THEN '1' WHEN ?6 IN( 'Premia Broker', 'Premia Direct', 'Premia Agent' ) THEN ?7 ELSE ?7 END ) ORDER BY HPM.EFFECTIVE_DATE DESC",nativeQuery=true)
   	List<Map<String,Object>> getPremiumReportDetailsCount(String productId,String branchCode,String startDate,String endDate,String loginId,String userType,String code);

	List<BranchMaster> findByCompanyId(String string);
   	  
	
	
}
